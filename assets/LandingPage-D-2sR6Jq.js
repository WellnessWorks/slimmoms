import{r as v,j as e,u as M,a as C}from"./index-Bmanl6Pj.js";const I="_formContainer_a2ynk_1",E="_row_a2ynk_9",S="_inputGroup_a2ynk_27",A="_fullWidth_a2ynk_32",D="_inputLabel_a2ynk_36",$="_inputField_a2ynk_42",T="_inputError_a2ynk_73",G="_errorMessage_a2ynk_77",O="_form_a2ynk_1",R="_radioOptions_a2ynk_104",K="_radioOption_a2ynk_104",P="_submitBtn_a2ynk_183",s={formContainer:I,row:E,inputGroup:S,fullWidth:A,inputLabel:D,inputField:$,inputError:T,errorMessage:G,form:O,radioOptions:R,radioOption:K,submitBtn:P},q=[{label:"A",value:"A"},{label:"B",value:"B"},{label:"AB",value:"AB"},{label:"0",value:"0"}],k=[{label:"Minimum (Sedentary)",value:"1.2"},{label:"Low (Light exercise 1-3 times/week)",value:"1.375"},{label:"Medium (Moderate exercise 3-5 times/week)",value:"1.55"},{label:"High (Hard exercise 6-7 times/week)",value:"1.725"},{label:"Maximum (Daily intense exercise or job)",value:"1.9"}],j=["height","age","currentWeight","desiredWeight"],b={height:{min:100,max:250,maxLength:3},age:{min:18,max:100,maxLength:3},currentWeight:{min:20,max:500,maxLength:3},desiredWeight:{min:20,max:500,maxLength:3}},H=r=>{const n={},t={};for(const o in r)o!=="bloodType"&&o!=="activityLevel"?t[o]=parseInt(r[o],10):t[o]=r[o];return!t.height||isNaN(t.height)?n.height="Height is required.":(t.height<100||t.height>250)&&(n.height="Height must be between 100 and 250 cm."),!t.age||isNaN(t.age)?n.age="Age is required.":(t.age<18||t.age>100)&&(n.age="Age must be between 18 and 100."),!t.currentWeight||isNaN(t.currentWeight)?n.currentWeight="Current weight is required.":(t.currentWeight<20||t.currentWeight>500)&&(n.currentWeight="Current weight must be between 20 and 500 kg."),!t.desiredWeight||isNaN(t.desiredWeight)?n.desiredWeight="Desired weight is required.":(t.desiredWeight<20||t.desiredWeight>500)&&(n.desiredWeight="Desired weight must be between 20 and 500 kg."),(!t.bloodType||!["A","B","AB","0"].includes(t.bloodType))&&(n.bloodType="Blood type is required."),(!r.activityLevel||!k.some(o=>o.value===r.activityLevel))&&(n.activityLevel="Activity level is required."),{errors:n,isValid:Object.keys(n).length===0}},V=({onFormSubmit:r,isLoading:n})=>{const[t,o]=v.useState({height:"",age:"",currentWeight:"",desiredWeight:"",bloodType:"",activityLevel:""}),[a,x]=v.useState({}),g=i=>{const{name:h,value:p}=i.target;let l=p;if(j.includes(h))if(p==="")l="";else{if(l=p.replace(/[^0-9]/g,"").replace(/^0+/,""),l==="")return;const d=b[h];d&&(parseInt(l,10)>d.max?l=String(d.max):d.maxLength&&l.length>d.maxLength&&(l=l.slice(0,d.maxLength)))}o(d=>({...d,[h]:l})),a[h]&&x(d=>{const _={...d};return delete _[h],_})},u=i=>{if(!j.includes(i.target.name)||["Backspace","Delete","ArrowLeft","ArrowRight","Tab","Home","End"].includes(i.key)||i.metaKey||i.ctrlKey||i.altKey)return;if(!/^[0-9]$/.test(i.key)){i.preventDefault();return}const{selectionStart:p,selectionEnd:l,value:d}=i.target,_=p===0&&l===0;i.key==="0"&&_&&d.length===0&&i.preventDefault()},L=i=>{i.preventDefault();const{errors:h,isValid:p}=H(t);if(!p){x(h),console.error("Form doğrulama hatası:",h);return}r(t),o({height:"",age:"",currentWeight:"",desiredWeight:"",bloodType:"",activityLevel:""}),x({})};return e.jsxs("div",{className:s.formContainer,children:[e.jsx("h1",{className:"page-title",children:"Calculate your daily calorie intake right now"}),e.jsxs("form",{className:s.form,onSubmit:L,children:[e.jsxs("div",{className:s.row,children:[e.jsxs("div",{className:s.inputGroup,children:[e.jsxs("label",{className:s.inputLabel,children:["Height *",e.jsx("input",{className:`${s.inputField} ${a.height?s.inputError:""}`,type:"text",name:"height",placeholder:"Enter your height (cm)",inputMode:"numeric",pattern:"[1-9][0-9]*",maxLength:b.height.maxLength,value:t.height,onChange:g,onKeyDown:u})]}),a.height&&e.jsx("span",{className:s.errorMessage,children:a.height})]}),e.jsxs("div",{className:s.inputGroup,children:[e.jsxs("label",{className:s.inputLabel,children:["Desired weight *",e.jsx("input",{className:`${s.inputField} ${a.desiredWeight?s.inputError:""}`,type:"text",name:"desiredWeight",placeholder:"Target weight (kg)",inputMode:"numeric",pattern:"[1-9][0-9]*",maxLength:b.desiredWeight.maxLength,value:t.desiredWeight,onChange:g,onKeyDown:u})]}),a.desiredWeight&&e.jsx("span",{className:s.errorMessage,children:a.desiredWeight})]})]}),e.jsxs("div",{className:s.row,children:[e.jsxs("div",{className:s.inputGroup,children:[e.jsxs("label",{className:s.inputLabel,children:["Age *",e.jsx("input",{className:`${s.inputField} ${a.age?s.inputError:""}`,type:"text",name:"age",placeholder:"How old are you?",inputMode:"numeric",pattern:"[1-9][0-9]*",maxLength:b.age.maxLength,value:t.age,onChange:g,onKeyDown:u})]}),a.age&&e.jsx("span",{className:s.errorMessage,children:a.age})]}),e.jsxs("div",{className:s.inputGroup,children:[e.jsx("span",{className:s.inputLabel,children:"Blood type *"}),e.jsx("div",{className:s.radioOptions,children:q.map(i=>e.jsxs("label",{className:s.radioOption,children:[e.jsx("input",{type:"radio",name:"bloodType",value:i.value,checked:t.bloodType===i.value,onChange:g}),e.jsx("span",{children:i.label})]},i.value))}),a.bloodType&&e.jsx("span",{className:s.errorMessage,children:a.bloodType})]})]}),e.jsx("div",{className:s.row,children:e.jsxs("div",{className:`${s.inputGroup} ${s.fullWidth}`,children:[e.jsxs("label",{className:s.inputLabel,children:["Current weight *",e.jsx("input",{className:`${s.inputField} ${a.currentWeight?s.inputError:""}`,type:"text",name:"currentWeight",placeholder:"Your current weight (kg)",inputMode:"numeric",pattern:"[1-9][0-9]*",maxLength:b.currentWeight.maxLength,value:t.currentWeight,onChange:g,onKeyDown:u})]}),a.currentWeight&&e.jsx("span",{className:s.errorMessage,children:a.currentWeight})]})}),e.jsx("div",{className:s.row,children:e.jsxs("div",{className:`${s.inputGroup} ${s.fullWidth}`,children:[e.jsxs("label",{className:s.inputLabel,children:["Activity level *",e.jsxs("select",{name:"activityLevel",value:t.activityLevel,onChange:g,className:`${s.inputField} ${a.activityLevel?s.inputError:""}`,children:[e.jsx("option",{value:"",disabled:!0,children:"Select activity level"}),k.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))]})]}),a.activityLevel&&e.jsx("span",{className:s.errorMessage,children:a.activityLevel})]})}),e.jsx("button",{type:"submit",className:`calculation-btn ${s.submitBtn}`,disabled:n,children:n?"Calculating...":"Start losing weight"})]})]})},X="_backdrop_g098r_1",U="_modalWrapper_g098r_14",Y="_topBar_g098r_21",J="_closeButtonMobile_g098r_34",Z="_closeIcon_g098r_45",z="_closeButtonDesktop_g098r_50",Q="_modalContent_g098r_54",ee="_closeXIcon_g098r_71",y={backdrop:X,modalWrapper:U,topBar:Y,closeButtonMobile:J,closeIcon:Z,closeButtonDesktop:z,modalContent:Q,closeXIcon:ee},te=({className:r})=>e.jsx("svg",{className:r,width:"15",height:"9",viewBox:"0 0 15 9",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M13.4142 1.20703V4.20703H1.41418M1.41418 4.20703L4.91418 0.707031M1.41418 4.20703L4.91418 7.70703",stroke:"black",strokeWidth:"2"})}),se=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:y.closeXIcon,children:[e.jsx("g",{clipPath:"url(#clip0_13001_132)",children:e.jsx("path",{d:"M15.8333 5.3415L14.6583 4.1665L9.99998 8.82484L5.34164 4.1665L4.16664 5.3415L8.82498 9.99984L4.16664 14.6582L5.34164 15.8332L9.99998 11.1748L14.6583 15.8332L15.8333 14.6582L11.175 9.99984L15.8333 5.3415Z",fill:"black"})}),e.jsx("defs",{children:e.jsx("clipPath",{id:"clip0_13001_132",children:e.jsx("rect",{width:"20",height:"20"})})})]}),ne=({isOpen:r,onClose:n,children:t})=>{if(v.useEffect(()=>{if(!r)return;const a=x=>{x.key==="Escape"&&n()};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[r,n]),!r)return null;const o=a=>{a.target===a.currentTarget&&n()};return e.jsx("div",{className:y.backdrop,onClick:o,children:e.jsxs("div",{className:y.modalWrapper,children:[e.jsx("div",{className:y.topBar,children:e.jsx("button",{className:y.closeButtonMobile,onClick:n,children:e.jsx(te,{className:y.closeIcon})})}),e.jsx("button",{className:y.closeButtonDesktop,onClick:n,children:e.jsx(se,{})}),e.jsx("div",{className:y.modalContent,children:t})]})})},ie="_intakeTitle_1303n_1",ae="_rateBox_1303n_5",re="_dailyRate_1303n_14",oe="_unit_1303n_20",le="_divider_1303n_27",ce="_subtitle_1303n_33",de="_foodList_1303n_41",ue="_foodItem_1303n_48",he="_noFoodItem_1303n_55",me="_intakeButtonFix_1303n_62",ge="_intakeBody_1303n_74",m={intakeTitle:ie,rateBox:ae,dailyRate:re,unit:oe,divider:le,subtitle:ce,foodList:de,foodItem:ue,noFoodItem:he,intakeButtonFix:me,intakeBody:ge},pe=({dailyRate:r,forbiddenFoods:n,onClose:t})=>{const o=M(),a=()=>{t&&t(),o("/login")},x=n&&n.length>0;return e.jsxs("div",{className:m.intakeBody,children:[e.jsx("h2",{className:`page-title ${m.intakeTitle}`,children:"Your recommended daily calorie intake is"}),e.jsxs("div",{className:m.rateBox,children:[e.jsx("span",{className:`modal-calorie-text ${m.dailyRate}`,children:r}),e.jsx("span",{className:m.unit,children:" kkal"})]}),e.jsx("hr",{className:m.divider}),e.jsx("h3",{className:m.subtitle,children:"Foods you should not eat"}),e.jsx("ol",{className:m.foodList,children:x?n.map((g,u)=>e.jsx("li",{className:m.foodItem,children:g},u)):e.jsx("li",{className:m.noFoodItem,children:"No forbidden foods for your blood type"})}),e.jsx("button",{onClick:a,className:`calculation-btn ${m.intakeButtonFix}`,children:"Start losing weight"})]})},xe="_LandingPageWrapper_23foe_1",_e="_mainContent_23foe_6",N={LandingPageWrapper:xe,mainContent:_e},ve=r=>{const n=[...r];let t=n.length,o;for(;t!==0;)o=Math.floor(Math.random()*t),t--,[n[t],n[o]]=[n[o],n[t]];return n},ye=r=>{const n={A:1,B:2,AB:3,0:4},t=Number(r);return[1,2,3,4].includes(t)?t:n[r]?n[r]:null},Le=()=>{const[r,n]=v.useState(!1),[t,o]=v.useState(null),[a,x]=v.useState([]),[g,u]=v.useState(!1),[L,i]=v.useState(null),h=async l=>{u(!0),i(null);const d=ye(l.bloodType);if(d===null){const c="Blood type is required.";console.error(c),i(c),u(!1);return}const _=Number(l.activityLevel);if(isNaN(_)||_<=0){const c="Activity level is invalid or missing.";console.error(c),i(c),u(!1);return}const w={height:Number(l.height),age:Number(l.age),weight:Number(l.currentWeight),targetWeight:Number(l.desiredWeight),bloodGroup:d,activityLevel:_},B="https://slimmoms-j4sf.onrender.com/api/v1/calories/intake";try{const c=await C.post(B,w),{dailyRate:f,forbiddenFoods:W}=c.data,F=ve(W).slice(0,5);o(f),x(F),n(!0)}catch(c){let f=c.message||"Bilinmeyen bir hata oluştu.";c.response&&c.response.data?(c.response.data.message?f=c.response.data.message:c.response.data.error&&(f=c.response.data.error),console.error("Full error response:",JSON.stringify(c.response.data,null,2))):c.response&&c.response.status===400&&(f="Backend doğrulama hatası. Lütfen tüm alanları kontrol edin."),i(f)}finally{u(!1)}},p=()=>{n(!1),i(null)};return v.useEffect(()=>{r?document.body.style.overflow="hidden":document.body.style.overflow="unset"},[r]),e.jsxs("div",{className:N.LandingPageWrapper,children:[e.jsxs("main",{className:N.mainContent,children:[e.jsx(V,{onFormSubmit:h,isLoading:g}),L&&e.jsx("div",{className:N.errorMessage,onClick:()=>i(null),children:L})]}),r&&t!==null&&e.jsx(ne,{isOpen:r,onClose:p,children:e.jsx(pe,{dailyRate:t,forbiddenFoods:a,onClose:p})})]})};export{Le as default};
